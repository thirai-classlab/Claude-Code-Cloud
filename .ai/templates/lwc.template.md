# LWC コンポーネント 設計書テンプレート

目的: LWC の責務、公開属性、イベント、API 連携、アクセシビリティ、テスト基準を明確にするテンプレート。

---

## メタ
- title: <short title>
- feature_name: <FEATURE_NAME>
- module: lwc
- source_path: force-app/main/default/lwc/<componentName>/
- generated_at: <ISO8601>

---

## 目次
1. [概要](#1-概要)
2. [画面設計](#2-画面設計)
3. [公開プロパティ/API](#3-公開プロパティapi)
4. [イベント/コールバック](#4-イベントコールバック)
5. [UI/アクセシビリティ](#5-uiアクセシビリティ)
6. [テスト](#6-テスト)
7. [個別処理（ステップ詳細）](#7-個別処理ステップ詳細)
8. [デプロイ/依存](#8-デプロイ依存)
9. [変更仕様マトリクス](#9-変更仕様マトリクス)
10. [改訂履歴](#10-改訂履歴)

---

## 1. 概要
- コンポーネントの目的、ユーザーインタラクション、表示要件

## 2. 画面設計
- 画面構成（領域/コンポーネント階層/コンテナ）
- 入力/表示項目一覧（ラベル/（API 名）/型/必須/初期値/バリデーション/権限制御）
- アクションとイベント → 呼び出し先（Apex/ナビゲーション/イベント）対応表
- 画面状態と遷移（ローディング/編集/保存/エラー/空状態）
- エラーハンドリング/ユーザ通知（トースト等）、レスポンシブ/i18n/アクセシビリティ（ARIA/キーボード）
- Mermaid 図: 任意（flowchart TD）。ノード/エッジに本文アンカー参照（click 指令）を付与

## 3. 公開プロパティ/API
- @api で公開するプロパティ一覧、型、必須/任意
- 親コンポーネントとの連携仕様

## 4. イベント/コールバック
- 発火するカスタムイベント、イベントペイロード定義

 - Mermaid 図: コンポーネントの振る舞いが複雑な場合は Mermaid のシーケンス図/フロー図を追加してください。図内で重要な処理やコール（Apex 呼出し等）がある場合は、対応する設計書内節へのアンカーリンクを付与してください。
	 - 重要: Mermaid ノード内に Markdown リンクを入れず、また HTML タグ（`<br/>` 含む）を使用しないこと。改行は `\\n` を使い、アンカー遷移は `click` 指令で実装してください。
	 - オブジェクト定義参照: 設計書作成時は `doc/object/` の定義を参照し、必要情報が無ければオブジェクト定義書の更新を提案してください。

## 5. UI/アクセシビリティ
- キーボード操作、スクリーンリーダ対策、ARIA 属性

## 6. テスト
- Jest テストケース（レンダリング、イベント、アクセシビリティ）

### プログラム仕様チェックリスト（実施すべきテスト一覧）
- コンポーネントの表示確認（各プロパティ組合せ）
- イベントが正しく伝播するか
- レスポンシブ表示の確認
- アクセシビリティのベーシックチェック（Tab キー、ラベル）

### バグチェック（プログラム観点での必須アサーション）
- UI 操作やイベント発火に対して、次を明記し自動テスト（Jest / e2e）で検証すること:
	- 前提データ: コンポーネントに渡す @api プロパティやモック API レスポンス
	- 実行操作: ボタン押下、フォーム送信、カスタムイベント発火 などの操作
	- 期待アサーション: API 呼び出しが行われた/レコードが作成されたこと（モックの呼出し回数や引数）、DOM に期待値が描画されていること
	- 例: ボタン押下で `save()` を呼び出し、mock Apex が呼ばれた後に `ServiceGuide__c` が作成される想定なら、mock 呼出し引数と戻り値を検証し、結果の DOM 表示を確認する

## 7. 個別処理（ステップ詳細）
- 見出し（タイトル）は日本語で記載すること。
- Mermaid 図や他セクションから参照できるよう、半角英数・ハイフンのみの英小文字スラッグをアンカー名として併記すること。
	- 例: `### 保存ボタンクリック時の検証と保存処理 (anchor: handle-save)` または 見出し直下に `Anchor: handle-save`

## 8. デプロイ/依存
- 必要な権限、静的リソース、Named Credentials など

---

## 9. 変更仕様マトリクス
| 発生場所(Where) | 発火タイミング/条件(When/If) | 方式 | 対象オブジェクト | 対象レコード特定条件 | 対象項目(Label/API/型) | 変更内容(Before→After/算出式) | 権限要件 | 例外時動作/リトライ | ログ/監査 | 備考 |
|---|---|---|---|---|---|---|---|---|---|---|

## 10. 改訂履歴
| バージョン | 日付 | セクション | 追加機能 | ヒアリング（相手/根拠） | 変更者 | 備考 |
|---|---|---|---|---|---|---|
| 0.1 | YYYY-MM-DD | 概要 | 初版 | Yes(<stakeholder>/meeting) | <author> | - |
